# LeanVibe Agent Hive 2.0 - Production Environment Configuration
# ================================================================
# This unified configuration resolves all environment blockers
# and provides production-ready deployment settings.

# ================================================================
# CORE APPLICATION SETTINGS
# ================================================================
APP_NAME="LeanVibe Agent Hive"
APP_VERSION="2.0.0"
ENVIRONMENT=production
LOG_LEVEL=INFO
DEBUG=false

# ================================================================
# DATABASE CONFIGURATION - RESOLVED PORTS
# ================================================================
# Using aligned production ports that match docker-compose.production.yml
POSTGRES_DB=leanvibe_agent_hive
POSTGRES_USER=leanvibe_user
POSTGRES_PORT=5432  # Production standard port (internal to Docker)
DATABASE_URL=postgresql+asyncpg://leanvibe_user:${POSTGRES_PASSWORD}@postgres:5432/leanvibe_agent_hive
DATABASE_POOL_SIZE=50
DATABASE_MAX_OVERFLOW=100

# ================================================================
# REDIS CONFIGURATION - RESOLVED PORTS  
# ================================================================
# Using aligned production ports that match docker-compose.production.yml
REDIS_PORT=6379  # Production standard port (internal to Docker) 
REDIS_URL=redis://:${REDIS_PASSWORD}@redis:6379/0
REDIS_STREAM_MAX_LEN=50000

# ================================================================
# SECURITY CONFIGURATION
# ================================================================
# These MUST be set via environment variables in production
SECRET_KEY=${SECRET_KEY}
JWT_SECRET_KEY=${JWT_SECRET_KEY}
JWT_ALGORITHM=HS256
JWT_ACCESS_TOKEN_EXPIRE_MINUTES=1440

# ================================================================
# API SERVICE CONFIGURATION - PRODUCTION PORTS
# ================================================================
# Production API runs on standard port 8000 inside container
# External access via Nginx on ports 80/443
API_HOST=0.0.0.0
API_PORT=8000
API_WORKERS=4

# ================================================================
# CORS AND SECURITY - PRODUCTION DOMAINS
# ================================================================
CORS_ORIGINS=https://${DOMAIN_NAME},https://www.${DOMAIN_NAME},https://app.${DOMAIN_NAME}
ALLOWED_HOSTS=${DOMAIN_NAME},www.${DOMAIN_NAME},app.${DOMAIN_NAME}

# ================================================================
# AI SERVICE CONFIGURATION
# ================================================================
ANTHROPIC_API_KEY=${ANTHROPIC_API_KEY}
ANTHROPIC_MODEL=claude-3-5-sonnet-20241022
OPENAI_API_KEY=${OPENAI_API_KEY}

# ================================================================
# PWA CONFIGURATION
# ================================================================
PWA_NAME=LeanVibe Agent Hive
PWA_SHORT_NAME=LeanVibe
PWA_DESCRIPTION=Autonomous Development Platform
PWA_THEME_COLOR=#1f2937
PWA_BACKGROUND_COLOR=#ffffff
PWA_DISPLAY=standalone
PWA_ORIENTATION=portrait

# ================================================================
# WEBSOCKET CONFIGURATION
# ================================================================
WEBSOCKET_HEARTBEAT_INTERVAL=30
WEBSOCKET_TIMEOUT=300
WEBSOCKET_MAX_CONNECTIONS_PER_IP=50

# ================================================================
# PERFORMANCE CONFIGURATION
# ================================================================
MAX_REQUESTS_PER_MINUTE=2000
CACHE_TTL=3600
SESSION_TIMEOUT=86400
WORKER_CONNECTIONS=1000

# ================================================================
# MONITORING CONFIGURATION
# ================================================================
PROMETHEUS_ENABLED=true
PROMETHEUS_PORT=9090
GRAFANA_ENABLED=true
GRAFANA_ADMIN_USER=${GRAFANA_ADMIN_USER}
GRAFANA_ADMIN_PASSWORD=${GRAFANA_ADMIN_PASSWORD}
METRICS_RETENTION_DAYS=90

# ================================================================
# FIREBASE FCM CONFIGURATION
# ================================================================
FIREBASE_PROJECT_ID=${FIREBASE_PROJECT_ID}
FIREBASE_PRIVATE_KEY_ID=${FIREBASE_PRIVATE_KEY_ID}
FIREBASE_PRIVATE_KEY=${FIREBASE_PRIVATE_KEY}
FIREBASE_CLIENT_EMAIL=${FIREBASE_CLIENT_EMAIL}
FIREBASE_CLIENT_ID=${FIREBASE_CLIENT_ID}
FCM_SERVER_KEY=${FCM_SERVER_KEY}
VAPID_PUBLIC_KEY=${VAPID_PUBLIC_KEY}
VAPID_PRIVATE_KEY=${VAPID_PRIVATE_KEY}
VAPID_SUBJECT=mailto:${ADMIN_EMAIL}

# ================================================================
# SSL/TLS CONFIGURATION
# ================================================================
SSL_CERT_PATH=/etc/nginx/ssl/cert.pem
SSL_KEY_PATH=/etc/nginx/ssl/key.pem
SSL_PROTOCOLS=TLSv1.2 TLSv1.3
HSTS_MAX_AGE=31536000

# ================================================================
# CONTAINER RESOURCE LIMITS
# ================================================================
API_MEMORY_LIMIT=2G
API_CPU_LIMIT=1.0
POSTGRES_MEMORY_LIMIT=2G
POSTGRES_CPU_LIMIT=1.0
REDIS_MEMORY_LIMIT=1G
REDIS_CPU_LIMIT=0.5
NGINX_MEMORY_LIMIT=512M
NGINX_CPU_LIMIT=0.5

# ================================================================
# BACKUP CONFIGURATION
# ================================================================
BACKUP_ENABLED=true
BACKUP_SCHEDULE="0 2 * * *"  # Daily at 2 AM
BACKUP_RETENTION_DAYS=30
BACKUP_S3_BUCKET=${BACKUP_S3_BUCKET}
BACKUP_S3_REGION=${BACKUP_S3_REGION}

# ================================================================
# ALERTING CONFIGURATION
# ================================================================
ALERT_EMAIL=${ADMIN_EMAIL}
ALERT_WEBHOOK=${ALERT_WEBHOOK}
CRITICAL_ALERT_THRESHOLD=95
WARNING_ALERT_THRESHOLD=80

# ================================================================
# CONTRACT TESTING FRAMEWORK
# ================================================================
CONTRACT_TESTING_ENABLED=true
CONTRACT_VALIDATION_ON_DEPLOY=true
CONTRACT_VIOLATION_ALERTS=true
CONTRACT_PERFORMANCE_THRESHOLD_MS=5

# ================================================================
# RATE LIMITING
# ================================================================
API_RATE_LIMIT=1000
WEBSOCKET_RATE_LIMIT=100
AUTH_RATE_LIMIT=20
UPLOAD_RATE_LIMIT=10

# ================================================================
# HEALTH CHECK CONFIGURATION
# ================================================================
HEALTH_CHECK_INTERVAL=30
HEALTH_CHECK_TIMEOUT=10
HEALTH_CHECK_RETRIES=3
HEALTH_CHECK_START_PERIOD=60

# ================================================================
# MOBILE OPTIMIZATION
# ================================================================
MOBILE_CACHE_DURATION=86400
MOBILE_API_TIMEOUT=30
MOBILE_WEBSOCKET_TIMEOUT=300
MOBILE_MAX_PAYLOAD_SIZE=1048576

# ================================================================
# SECURITY HEADERS
# ================================================================
CSP_ENABLED=true
FRAME_OPTIONS=DENY
CONTENT_TYPE_OPTIONS=nosniff
XSS_PROTECTION=1; mode=block

# ================================================================
# NOTIFICATION CONFIGURATION
# ================================================================
PUSH_NOTIFICATION_ENABLED=true
NOTIFICATION_BATCH_SIZE=100
NOTIFICATION_RETRY_ATTEMPTS=3
NOTIFICATION_RETRY_DELAY=5

# ================================================================
# DOMAIN AND CDN CONFIGURATION
# ================================================================
DOMAIN_NAME=${DOMAIN_NAME}
CDN_ENABLED=true
CDN_URL=${CDN_URL}
STATIC_FILES_CDN=${STATIC_FILES_CDN}

# ================================================================
# ADMIN CONFIGURATION
# ================================================================
ADMIN_EMAIL=${ADMIN_EMAIL}
ADMIN_USER=${ADMIN_USER}
SUPPORT_EMAIL=${SUPPORT_EMAIL}

# ================================================================
# DEPLOYMENT METADATA
# ================================================================
BUILD_DATE=${BUILD_DATE}
VCS_REF=${VCS_REF}
DEPLOYMENT_ID=${DEPLOYMENT_ID}
DEPLOY_ENVIRONMENT=production